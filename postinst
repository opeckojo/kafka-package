#!/bin/sh
#
# postinst script for Kafka
#
# see dh_installdeb(1)

set -e

case "$1" in
  configure|reconfigure)
    if ! getent passwd kafka >/dev/null; then
      # Adding system user: kafka
      adduser \
        --system \
        --group \
        --home /var/lib/kafka \
        --gecos "Apache Kafka" \
	--shell /bin/bash \
        kafka >/dev/null 2>/dev/null || :
    fi

    # chown kafka directories
    chown kafka:kafka /var/log/kafka
    chown kafka:kafka /var/spool/kafka

    # when created on a mac, user is 501 :(
    chown -R root:root /etc/init.d/kafka
    chown -R root:root /etc/kafka
    chown -R root:root /etc/security/limits.d/kafka-nofiles.conf
    chown -R root:root /etc/sysconfig/kafka

    chown -R kafka:kafka /usr/lib/kafka
    chown -R kafka:kafka /var/lib/kafka
    update-rc.d kafka defaults 98 02
  ;;

  abort-upgrade|abort-remove|abort-deconfigure)
  ;;

  *)
    echo "postinst called with unknown argument \`$1'" >&2
    exit 1
  ;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
